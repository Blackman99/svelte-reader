import{S,i as $,s as w,e as v,c as y,j as R,k as b,f as m,a as k,b as x,l as u,m as C,p as q,o as L,t as O,g as T,d as j,h as A}from"./index-70cf4e1e.js";import{S as E}from"./SvelteReader-46b733b3.js";function U(p){let a,i,t,f,n,s,d=p[1]?"cancel":"speak",c,l,g,_;return t=new E({props:{url:"/svelte-reader/files/啼笑因缘.epub",getRendition:p[4]}}),t.$on("update:location",p[2]),{c(){a=v("div"),i=v("div"),y(t.$$.fragment),f=R(),n=v("div"),s=v("button"),c=b(d),m(i,"height","100vh"),k(s,"class","reader-button"),k(n,"class","speak svelte-lq6dic"),m(a,"position","relative")},m(e,o){x(e,a,o),u(a,i),C(t,i,null),u(a,f),u(a,n),u(n,s),u(s,c),l=!0,g||(_=q(s,"click",p[5]),g=!0)},p(e,[o]){const r={};o&1&&(r.getRendition=e[4]),t.$set(r),(!l||o&2)&&d!==(d=e[1]?"cancel":"speak")&&L(c,d)},i(e){l||(O(t.$$.fragment,e),l=!0)},o(e){T(t.$$.fragment,e),l=!1},d(e){e&&j(a),A(t),g=!1,_()}}}function V(p,a,i){let t=!1,f="",n=null,s=!1;const d=()=>{const e=n.getRange(n.currentLocation().start.cfi),o=n.getRange(n.currentLocation().end.cfi);e.setEnd(o.startContainer,o.startOffset),f=e.toString().replace(/\s\s/g,"").replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").replace(/\f/g,"")},c=e=>{e==="click"&&i(1,s=!s),s?l(f):(t=!1,window.speechSynthesis.cancel())},l=(e,o=1)=>{t=!0;const r=new SpeechSynthesisUtterance;r.text=e,r.voice=window.speechSynthesis.getVoices()[0],r.rate=o,window.speechSynthesis.speak(r),r.onerror=h=>{console.log(h)},r.onend=async h=>{!s&&!t||(n.next(),c())}};return[n,s,d,c,e=>i(0,n=e),()=>c("click")]}class D extends S{constructor(a){super(),$(this,a,V,U,w,{})}}export{D as default};
